<!--index.wxml-->
<view class="page-container">
  <!-- æ‚¬æµ®é€æ˜å¯¼èˆªæ ,å¸¦æ¨¡ç³ŠèƒŒæ™¯ -->
  <navigation-bar 
    title="é¦–é¡µ" 
    back="{{false}}" 
    color="#333333" 
    background="transparent"
    opacity="{{1}}"
  ></navigation-bar>
  
  <scroll-view class="scrollarea" scroll-y type="list">
    <view class="home-container">
      
      <!-- è½®æ’­å›¾ -->
      <view class="banner-section">
        <swiper 
          class="banner-swiper" 
          indicator-dots="{{true}}" 
          autoplay="{{true}}" 
          interval="{{3000}}" 
          duration="{{500}}"
          circular="{{true}}"
        >
          <swiper-item wx:for="{{banners}}" wx:key="id">
            <image class="banner-image" src="{{item.image_url}}" mode="aspectFill" bindtap="onBannerTap" data-link="{{item.link}}" />
          </swiper-item>
        </swiper>
      </view>

    <!-- åŠŸèƒ½åŒº -->
    <view class="function-section">
      <view 
        class="function-item" 
        wx:for="{{functions}}" 
        wx:key="id"
        bindtap="onFunctionTap"
        data-path="{{item.path}}"
        data-type="{{item.type}}"
      >
        <text class="function-icon-emoji">{{item.icon}}</text>
        <text class="function-name">{{item.name}}</text>
      </view>
    </view>

    <!-- å¹¿å‘Šè½®æ’­ -->
    <view class="ad-section" wx:if="{{ads.length > 0}}">
      <swiper 
        class="ad-swiper" 
        indicator-dots="{{true}}" 
        autoplay="{{true}}" 
        interval="{{4000}}"
        circular="{{true}}"
      >
        <swiper-item wx:for="{{ads}}" wx:key="id">
          <image class="ad-image" src="{{item.image_url}}" mode="aspectFill" bindtap="onAdTap" data-link="{{item.link}}" />
        </swiper-item>
      </swiper>
    </view>

    <!-- é›†æ¯å¡ -->
    <view class="loyalty-card-section" wx:if="{{loyaltyCard}}">
      <view class="loyalty-card">
        <view class="card-header">
          <text class="card-title">é›†æ¯å¡</text>
          <text class="card-subtitle">é›†æ»¡{{loyaltyCard.reward_threshold}}æ¯å¯å…‘æ¢</text>
        </view>
        <view class="cup-progress">
          <view class="cup-item" wx:for="{{loyaltyCard.reward_threshold}}" wx:key="index">
            <text class="cup-icon {{index < loyaltyCard.current_cups ? 'filled' : 'empty'}}">
              {{index < loyaltyCard.current_cups ? 'ğŸ¥¤' : 'âšª'}}
            </text>
          </view>
        </view>
        <view class="card-footer">
          <text class="cup-count">å·²é›† {{loyaltyCard.current_cups}}/{{loyaltyCard.reward_threshold}} æ¯</text>
          <button 
            class="redeem-btn {{loyaltyCard.is_redeemable ? 'active' : 'disabled'}}" 
            bindtap="onRedeemTap"
            disabled="{{!loyaltyCard.is_redeemable}}"
          >
            {{loyaltyCard.is_redeemable ? 'ç«‹å³å…‘æ¢' : 'ç»§ç»­åŠªåŠ›'}}
          </button>
        </view>
      </view>
    </view>

    <!-- åº—é“ºæƒ…å†µ -->
    <view class="shop-info-section">
      <view class="shop-info-card">
        <view class="shop-header">
          <text class="shop-name">{{shopInfo.name}}</text>
          <view class="shop-status {{shopInfo.status}}">
            <text class="status-dot"></text>
            <text class="status-text">{{shopInfo.status === 'open' ? 'è¥ä¸šä¸­' : 'å·²æ‰“çƒŠ'}}</text>
          </view>
        </view>
        <view class="shop-details">
          <view class="detail-item">
            <text class="detail-icon">ğŸ“</text>
            <text class="detail-text">{{shopInfo.address}}</text>
          </view>
          <view class="detail-item">
            <text class="detail-icon">ğŸ“</text>
            <text class="detail-text">{{shopInfo.phone}}</text>
          </view>
          <view class="detail-item">
            <text class="detail-icon">ğŸ•</text>
            <text class="detail-text">{{shopInfo.business_hours}}</text>
          </view>
        </view>
      </view>
    </view>

  </view>
</scroll-view>
</view>
